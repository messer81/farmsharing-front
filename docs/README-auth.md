# üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - FarmSharing

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üîë –¢–µ—Å—Ç–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
- **Email:** `test@example.com` | **–ü–∞—Ä–æ–ª—å:** `password123`
- **Email:** `admin@example.com` | **–ü–∞—Ä–æ–ª—å:** `password123` (–∞–¥–º–∏–Ω)

### üåê Google OAuth
- –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google" –≤ —Ñ–æ—Ä–º–µ –≤—Ö–æ–¥–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

---

## üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üìÑ –û—Å–Ω–æ–≤–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

1. **[auth-complete-guide.md](./auth-complete-guide.md)** üìã
   - üîê –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–ª–æ–∫–∞–ª—å–Ω–∞—è + Google OAuth)
   - üóÉÔ∏è JSON –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - üõ°Ô∏è JWT —Ç–æ–∫–µ–Ω—ã –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
   - üåç –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å
   - üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

2. **[latest-updates.md](./latest-updates.md)** üöÄ
   - ‚ú® –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–µ
   - üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
   - üìä –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ JSON –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
   - üõ†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

3. **[auth-testing-guide.md](./auth-testing-guide.md)** üß™
   - üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - üì± Postman –∫–æ–ª–ª–µ–∫—Ü–∏—è
   - üîç –û—Ç–ª–∞–¥–∫–∞ –æ—à–∏–±–æ–∫

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```mermaid
graph TD
    A[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å] --> B{–¢–∏–ø –≤—Ö–æ–¥–∞}
    B -->|Email/–ü–∞—Ä–æ–ª—å| C[–õ–æ–∫–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è]
    B -->|Google| D[Google OAuth 2.0]
    
    C --> E[–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö]
    D --> F[Google Callback]
    
    E --> G[–ü–æ–∏—Å–∫ –≤ JSON –ë–î]
    F --> G
    
    G --> H{–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω?}
    H -->|–î–∞| I[–ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT]
    H -->|–ù–µ—Ç| J[–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è]
    J --> I
    
    I --> K[–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞]
    K --> L[Frontend: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage]
    L --> M[–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Redux —Å–æ—Å—Ç–æ—è–Ω–∏—è]
```

---

## üóÉÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
data/
‚îú‚îÄ‚îÄ users.json         # üë• –•—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ userDatabase.cjs   # üîß API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON
```

### üë§ –§–æ—Ä–º–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```json
{
  "id": 1,
  "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
  "email": "ivan@example.com",
  "password": "$2b$10$...", // bcrypt hash
  "phone": "+7 (999) 123-45-67",
  "address": "—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 10, –∫–≤. 5",
  "preferredLanguage": "ru",
  "role": "user",
  "createdAt": "2024-01-01T10:00:00Z",
  "updatedAt": "2024-01-20T15:30:00Z",
  "googleId": "123456789" // —Ç–æ–ª—å–∫–æ –¥–ª—è Google –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
}
```

---

## üåê API Endpoints

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/auth/login` - –í—Ö–æ–¥ –ø–æ email/–ø–∞—Ä–æ–ª—é
- `GET /api/auth/google` - –ò–Ω–∏—Ü–∏–∞—Ü–∏—è Google OAuth
- `GET /api/auth/google/callback` - –û–±—Ä–∞–±–æ—Ç–∫–∞ Google callback

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `GET /api/auth/profile` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/auth/profile` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

### üìä –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- `GET /api/admin/users/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üìÑ –§–∞–π–ª `.env`
```env
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
JWT_SECRET=your-secure-jwt-secret-key-here
PORT=3000
NODE_ENV=development
```

### üåê Google Cloud Console
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OAuth consent screen
3. –°–æ–∑–¥–∞—Ç—å OAuth 2.0 credentials
4. –î–æ–±–∞–≤–∏—Ç—å redirect URI: `http://localhost:3000/api/auth/google/callback`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### üîç –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞
npm run dev

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
npm run dev:server  # http://localhost:3000
npm run dev:client  # http://localhost:5173
```

### üåê –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
1. –û—Ç–∫—Ä—ã—Ç—å http://localhost:5173
2. –ù–∞–∂–∞—Ç—å "–í–æ–π—Ç–∏" –≤ —Ö–µ–¥–µ—Ä–µ
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
   - ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –≤—Ö–æ–¥ (`test@example.com` / `password123`)
   - ‚úÖ Google OAuth (–∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google")
   - ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
curl http://localhost:3000/api/admin/users/stats
```

---

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

1. **–ü–æ—Ä—Ç 3000 –∑–∞–Ω—è—Ç**
   ```bash
   npm run kill-processes
   ```

2. **Google OAuth –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ redirect URI
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å OAuth consent screen

3. **–û—à–∏–±–∫–∏ JWT**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `JWT_SECRET` –≤ `.env`
   - –£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∞

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª `data/users.json`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- üîê –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
- üõ°Ô∏è JWT —Ç–æ–∫–µ–Ω—ã —Å –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- üåê CORS –ø–æ–ª–∏—Ç–∏–∫–∏
- üìù –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### üö® –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- ‚úÖ HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π JWT_SECRET
- ‚úÖ Rate limiting
- ‚úÖ 2FA —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

---

**üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –Ø–Ω–≤–∞—Ä—å 2025  
**üë®‚Äçüíª –°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é